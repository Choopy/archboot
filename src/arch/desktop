#!/bin/bash

#                       DESKTOP ENVIRONMENT
# ============================================================================
# Here we configure desktop environment and install required packages
# such as display server, fonts to prevent issues in gtk apps on some DE,
# terminal and numlockx to get numlock_ON on bootup.
# To prevent password issues on the login screen of the display manager
# caused by wrong keyboard layout, we add keyboard.conf to xorg settings.
# All steps are described in the official documentation:
# https://wiki.archlinux.org/index.php/Desktop_environment
# ============================================================================

_install_desktop_environment() {

    # Install Xorg
    _info "Installing xorg server"
    _chroot "pacman --noconfirm -S ${_xorg}"

    # Install Fonts
    _info "Installing fonts"
    _chroot "pacman --noconfirm -S ${_fonts}"

    # Install Numlock
    _info "Installing numlock"
    _chroot "pacman --noconfirm -S ${_numlock}"

    # Install Terminal
    _info "Installing terminal"
    _chroot "pacman --noconfirm -S ${_term}"

    # Install Desktop Environment
    _info "Installing ${desktop}"
    user_desktop="_${desktop}"
    _chroot "pacman --noconfirm -S ${!user_desktop}"
 }

_desktop_settings() {

    # Keyboard layout
    _info "Setting ${keymap_code} keyboard layout"
    wget ${_url}/conf/00-keyboard.conf
    sed -i -e "s/keymap_code/${keymap_code}/g" 00-keyboard.conf
    mv 00-keyboard.conf /mnt/etc/X11/xorg.conf.d/
}

# archboot by grm34 under Apache v2.0 License.
# ============================================================================
